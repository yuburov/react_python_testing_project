(this["webpackJsonpwebapp-ui"]=this["webpackJsonpwebapp-ui"]||[]).push([[0],{184:function(e,t,n){},185:function(e,t,n){},329:function(e,t,n){},330:function(e,t,n){},331:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(10),i=n.n(c),s=(n(184),n(185),n(33)),l=n(14),o=n(35),j=n(24),d=n(97),u=n(379),b=n(381),h=n(367),O=n(368),m=n(369),x=n(370),p=n(36),g=n(26),f=n(366),v=n(54),y=n.n(v),S=n(95),T=n.n(S),N=n(380),w=n(21),k="AUTH_START",C="AUTH_SUCCESS",A="AUTH_FAIL",I="AUTH_LOGOUT",q=function(e){return{type:C,token:e}},B=function(e){return{type:A,error:e}},_=function(){return localStorage.removeItem("token"),localStorage.removeItem("expirationDate"),{type:I}},L=function(e){return function(t){setTimeout((function(){t(_())}),1e3*e)}},D=function(e,t){return function(n){n({type:k}),y.a.post("http://127.0.0.1:8000/rest-auth/login/",{username:e,password:t}).then((function(e){var t=e.data.key,r=new Date((new Date).getTime()+36e5);localStorage.setItem("token",t),localStorage.setItem("expirationDate",r),n(q(t)),n(L(3600))})).catch((function(e){n(B(e))}))}},E=n(2),P=function(e){var t=e.placeholder,n=Object(d.a)(e,["placeholder"]),r=Object(p.d)(n),a=Object(j.a)(r,2),c=a[0],i=a[1],s=i.error&&i.touched?i.error:"";return Object(E.jsx)(u.a,Object(o.a)(Object(o.a)({placeholder:t},c),{},{helperText:s,error:!!s}))},F=T()((function(e){return{root:{width:"70%","& > * + *":{marginTop:e.spacing(2)},marginBottom:"25px",marginLeft:"auto",marginRight:"auto"}}})),R={surname:"",name:"",lastName:"",phone:"",address:"",inn:""};var U=function(e){var t=Object(r.useState)(!1),n=Object(j.a)(t,2),a=n[0],c=n[1],i=Object(w.b)(),s=F(),l=RegExp(/^\+?1?[6-9]\d{11,13}$/),o=null,d=Object(w.c)((function(e){return e.auth.error}));return d&&(o=Object(E.jsx)("div",{style:{marginBottom:"20px",textAlign:"center"},children:Object(E.jsx)("p",{style:{color:"red"},children:d.message})})),Object(E.jsxs)(b.a,{marginTop:5,marginBottom:4,children:[a?Object(E.jsx)("div",{className:s.root,children:Object(E.jsxs)(N.a,{onClose:function(){return c(!1)},children:[Object(E.jsx)("strong",{children:"Congrats!"})," You have successfully registered"]})}):null,Object(E.jsx)("h1",{style:{textAlign:"center",color:"white",marginBottom:"10px"},children:"Registration form"}),o,Object(E.jsx)(f.a,{maxWidth:"md",children:Object(E.jsx)(h.a,{children:Object(E.jsx)(O.a,{children:Object(E.jsx)(p.c,{validateOnChange:!0,validationSchema:Object(g.a)({surname:Object(g.b)().required(),name:Object(g.b)().required(),lastName:Object(g.b)().required(),phone:Object(g.b)().required().matches(l,"Phone number is not valid"),address:Object(g.b)().required(),inn:Object(g.b)().required()}),initialValues:R,onSubmit:function(e,t){var n=e.surname,r=e.name,a=e.lastName,s=e.phone,l=e.address,o=e.inn,j=t.setSubmitting,d=t.resetForm;v.post("http://127.0.0.1:8000/api/user/create/",{surname:n,name:r,lastName:a,phone:s,address:l,inn:o}).then((function(e){return d({}),c(!0),e.data})).catch((function(e){i(B(e))})),j(!1)},children:function(e){e.values,e.errors;var t=e.isSubmitting,n=e.isValidating;return Object(E.jsxs)(p.b,{autoComplete:"off",children:[Object(E.jsx)(b.a,{marginBottom:2,marginTop:2,children:Object(E.jsx)(m.a,{children:Object(E.jsx)(P,{placeholder:"Surname",name:"surname",type:"input",label:"Surname"})})}),Object(E.jsx)(b.a,{marginBottom:2,children:Object(E.jsx)(m.a,{children:Object(E.jsx)(P,{placeholder:"Name",name:"name",type:"input",label:"Name"})})}),Object(E.jsx)(b.a,{marginBottom:2,children:Object(E.jsx)(m.a,{children:Object(E.jsx)(P,{placeholder:"Last name",name:"lastName",type:"input",label:"Last name"})})}),Object(E.jsx)(b.a,{marginBottom:2,children:Object(E.jsx)(m.a,{children:Object(E.jsx)(P,{placeholder:"Phone (example: +996555224422)",name:"phone",type:"input",label:"Phone"})})}),Object(E.jsx)(b.a,{marginBottom:2,children:Object(E.jsx)(m.a,{children:Object(E.jsx)(P,{placeholder:"Address",name:"address",type:"input",label:"Address"})})}),Object(E.jsx)(b.a,{marginBottom:2,children:Object(E.jsx)(m.a,{children:Object(E.jsx)(P,{placeholder:"Inn",name:"inn",type:"input",label:"Inn"})})}),Object(E.jsx)(x.a,{variant:"contained",color:"primary",type:"submit",disabled:t||n,children:"Save"})]})}})})})})]})},W=n(372),H=n(374),V=n(378),J=n(377),M=n(373),X=n(375),z=n(376),G=n(336),Y=n(371),$=T()((function(e){return{root:{display:"flex","& > * + *":{marginLeft:e.spacing(2)},justifyContent:"center",marginTop:"250px"}}}));function K(){var e=$();return Object(E.jsx)("div",{className:e.root,children:Object(E.jsx)(Y.a,{color:"secondary"})})}var Q=Object(W.a)({table:{minWidth:320}});var Z=function(e){var t=Object(r.useState)([]),n=Object(j.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(!1),s=Object(j.a)(i,2),o=s[0],d=s[1],u=Object(w.c)((function(e){return null!==e.auth.token})),h=Object(l.f)();Object(r.useEffect)((function(){d(!0),v.get("http://127.0.0.1:8000/api/",{headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))}}).then((function(e){c(e.data),d(!1)}))}),[]);var O=Q();if(u){if(o)return Object(E.jsx)(K,{})}else h.push("/login");return Object(E.jsx)(b.a,{marginTop:5,marginBottom:4,children:Object(E.jsxs)(f.a,{maxWidth:"md",children:[Object(E.jsx)("h1",{style:{textAlign:"center",color:"white",marginBottom:"10px"},children:"List of users"}),Object(E.jsx)(M.a,{component:G.a,children:Object(E.jsxs)(H.a,{className:O.table,"aria-label":"simple table",children:[Object(E.jsx)(X.a,{children:Object(E.jsxs)(z.a,{children:[Object(E.jsx)(J.a,{children:"Surname"}),Object(E.jsx)(J.a,{align:"right",children:"Name"}),Object(E.jsx)(J.a,{align:"right",children:"Last name"}),Object(E.jsx)(J.a,{align:"right",children:"Phone"}),Object(E.jsx)(J.a,{align:"right",children:"Address"}),Object(E.jsx)(J.a,{align:"right",children:"Inn"})]})}),Object(E.jsx)(V.a,{children:a.map((function(e){return Object(E.jsxs)(z.a,{children:[Object(E.jsx)(J.a,{component:"th",scope:"row",children:e.surname}),Object(E.jsx)(J.a,{align:"right",children:e.name}),Object(E.jsx)(J.a,{align:"right",children:e.lastName}),Object(E.jsx)(J.a,{align:"right",children:e.phone}),Object(E.jsx)(J.a,{align:"right",children:e.address}),Object(E.jsx)(J.a,{align:"right",children:e.inn})]},e.name)}))})]})})]})})},ee=(n(329),function(e){e.fullWidth;var t=e.required,n=void 0!==t&&t,r=e.label,a=e.type,c=void 0===a?"text":a,i=Object(d.a)(e,["fullWidth","required","label","type"]),s=Object(p.d)(i),l=Object(j.a)(s,2),b=l[0],h=l[1],O=h.error&&h.touched?h.error:"";return Object(E.jsx)("div",{className:"formikField",children:Object(E.jsx)(p.a,Object(o.a)(Object(o.a)({type:c,required:n,fullWidth:!0,as:u.a,label:r},b),{},{helperText:O,error:!!O}))})}),te={username:"",password:""},ne=g.a().shape({username:g.b().min(4,"Too Short!").required("Required"),password:g.b().min(5,"Too Short!").required("Required")}),re=function(e){var t=Object(w.c)((function(e){return null!==e.auth.token})),n=Object(w.c)((function(e){return e.auth.loading})),r=Object(l.f)(),a=Object(w.b)(),c=null,i=Object(w.c)((function(e){return e.auth.error}));if(i&&(c=Object(E.jsx)("div",{style:{marginBottom:"20px",textAlign:"center"},children:Object(E.jsx)("p",{style:{color:"red"},children:i.message})})),t)r.push("/admin_page");else if(n)return Object(E.jsx)(K,{});return Object(E.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(E.jsxs)("div",{className:"login",children:[Object(E.jsx)("h1",{style:{textAlign:"center"},children:"Sign In"}),c,Object(E.jsx)(p.c,{initialValues:te,onSubmit:function(e){a(D(e.username,e.password))},validationSchema:ne,children:function(e){var t=e.dirty,n=e.isValid;return Object(E.jsxs)(p.b,{children:[Object(E.jsx)(ee,{name:"username",label:"Name",required:!0}),Object(E.jsx)(ee,{name:"password",type:"password",label:"Password",required:!0}),Object(E.jsx)(x.a,{variant:"contained",color:"primary",disabled:!t||!n,type:"submit",children:"Sign In"})]})}})]})})},ae=(n(330),function(){var e=Object(w.c)((function(e){return null!==e.auth.token})),t=Object(w.b)();return Object(E.jsxs)("nav",{children:[Object(E.jsxs)("div",{className:"logo",children:["Test",Object(E.jsx)("font",{children:"Project"})]}),Object(E.jsxs)("ul",{className:"menu-list",children:[Object(E.jsx)("li",{children:Object(E.jsx)(s.c,{exact:!0,to:"/",activeClassName:"active",children:"Home"})}),e?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("li",{children:Object(E.jsx)(s.c,{exact:!0,to:"/admin_page",activeClassName:"active",children:"Admin page"})}),Object(E.jsx)("li",{children:Object(E.jsx)(s.b,{activeClassName:"active",children:Object(E.jsx)("span",{onClick:function(){t(_())},children:"Logout"})})})]}):Object(E.jsx)("li",{children:Object(E.jsx)(s.c,{exact:!0,to:"/login",activeClassName:"active",children:"Login"})})]})]})});var ce=function(){var e=Object(w.b)();return Object(r.useEffect)((function(){e((function(e){var t=localStorage.getItem("token");if(void 0===t)e(_());else{var n=new Date(localStorage.getItem("expirationDate"));n<=new Date?e(_()):(e(q(t)),e(L((n.getTime()-(new Date).getTime())/1e3)))}}))}),[]),Object(E.jsx)(s.a,{children:Object(E.jsxs)("div",{className:"App",children:[Object(E.jsx)(ae,{}),Object(E.jsxs)(l.c,{children:[Object(E.jsx)(l.a,{path:"/",exact:!0,children:Object(E.jsx)(U,{})}),Object(E.jsx)(l.a,{path:"/admin_page",exact:!0,children:Object(E.jsx)(Z,{})}),Object(E.jsx)(l.a,{path:"/login",exact:!0,children:Object(E.jsx)(re,{})})]})]})})},ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,382)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))},se=n(49),le=n(170),oe=function(e,t){return Object(o.a)(Object(o.a)({},e),t)},je={token:null,error:null,loading:!1},de=function(e,t){return oe(e,{error:null,loading:!0})},ue=function(e,t){return oe(e,{token:t.token,error:null,loading:!1})},be=function(e,t){return oe(e,{error:t.error,loading:!1})},he=function(e,t){return oe(e,{token:null})},Oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return de(e);case C:return ue(e,t);case A:return be(e,t);case I:return he(e);default:return e}},me=Object(se.c)({auth:Oe}),xe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||se.d,pe=Object(se.e)(me,xe(Object(se.a)(le.a)));i.a.render(Object(E.jsx)(a.a.StrictMode,{children:Object(E.jsx)(w.a,{store:pe,children:Object(E.jsx)(ce,{})})}),document.getElementById("root")),ie()}},[[331,1,2]]]);
//# sourceMappingURL=main.15c39c40.chunk.js.map